<template>
  <section class="font-20 justify center mt-60 scroll">
    <Row type="flex" justify="center" class="mt-60">
      <Col span="20">
        <h1>
          Acuerdo del participante, liberación y asunción de riesgos (El
          Acuerdo) - Sociedad HAPPYLAND Perú S.A.
        </h1>
        <p class="paragraph mt-60">
          Elegí voluntariamente usar y, si corresponde, permitir que los niños
          menores identificados anteriormente y todos los niños menores bajo mi
          supervisión y referidos individual y colectivamente en este documento
          como "Niños", usen las instalaciones y equipos de Sociedad HAPPYLAND
          Perú S.A. (dirección fiscal) (la "Instalación de obstáculos de
          Happyland Adventure "). En consideración a que se le permita usar
          dichas instalaciones y equipos, y cualquier otro servicio
          proporcionado por Sociedad Happyland Péru o sus empleados o agentes en
          dicha ubicación, o en cualquier otra ubicación dentro de la ciudad de
          Lima, declaro, reconozco y acepto lo siguiente: Reconozco y acepto que
          este Acuerdo cubre y está destinado a liberar y proporcionar otros
          beneficios, protecciones legales y consideración a Sociedad HAPPYLAND
          Perú S.A., y sus respectivos agentes y colectivos, propietarios,
          funcionarios, gerentes, accionistas, afiliados, voluntarios,
          participantes, empleados, y todas las demás personas o entidades que
          actúen en cualquier capacidad en su nombre respectivo o colectivo
          (colectivamente, Sociedad HAPPYLAND Perú S.A.) !!! - LIBERACIÓN DE
          LESIONES POTENCIALES Reconozco y acepto que el uso de trampolines y
          otros equipos en Sociedad HAPPYLAND Perú S.A. y que participar en
          trampolines y otras actividades (detallar todas las atracciones de
          Happyland Adventure) es inherentemente y obviamente peligroso. Estos
          riesgos incluyen lesiones físicas o emocionales graves, parálisis,
          muerte, daños a mí mismo, al Niño y / o a terceros, y daños a la
          propiedad personal de cualquiera o todas esas personas. Entiendo que
          tales riesgos simplemente no pueden eliminarse sin poner en peligro
          las cualidades esenciales de la actividad, lo cual acepto además es
          para fines recreativos y completamente voluntario. Reconozco y acepto
          que, si bien los empleados de Sociedad HAPPYLAND Perú S.A. supervisan
          generalmente el trampolín y otras actividades que tienen lugar en
          Sociedad HAPPYLAND Perú S.A., no es factible que dichos empleados
          supervisen las actividades y acciones de todos los clientes en todo
          momento o todos Clientes simultáneamente. Además, los empleados de
          Sociedad HAPPYLAND Perú S.A. tienen trabajos difíciles de realizar.
          Buscan seguridad, pero no son infalibles. Es posible que no conozcan
          la salud o las habilidades de un participante. Pueden dar advertencias
          o instrucciones incompletas, y el equipo que se está utilizando podría
          funcionar mal. !!! - ASUNCIÓN VOLUNTARIA DE RIESGO Reconozco y acepto
          que yo y el niño estamos participando voluntariamente bajo nuestro
          propio riesgo. Reconozco y acepto que las acciones o actividades de
          otros clientes o las acciones o inacciones de los empleados de
          Sociedad HAPPYLAND Perú S.A. podrían causarme a mí o al Niño lesiones
          corporales significativas (como se describe en este Acuerdo), y que
          Sociedad HAPPYLAND Perú S.A. no es responsable de las acciones o
          actividades de clientes que usan la Instalación de Sociedad HAPPYLAND
          Perú S.A.o la negligencia de sus empleados en la supervisión de la
          Instalación de obstáculos de Happyland Adventure o su uso, incluidas
          las acciones, actividades u omisiones que resultan en dicho daño.
          Algunos de los riesgos incluyen, entre otros, los siguientes: a) Los
          participantes pueden morir o quedar paralizados, parcial o totalmente,
          a través del uso de la instalación de Sociedad HAPPYLAND Perú S.A.y la
          participación en actividades de Sociedad HAPPYLAND Perú S.A.. b) Los
          participantes pueden sufrir cortes, raspones, golpes, contusiones,
          conmociones cerebrales, la transmisión de cepas de enfermedades y
          reacciones alérgicas a través del uso del equipo Sociedad HAPPYLAND
          Perú S.A. o el contacto con otros participantes o superficies con las
          que han contactado. Los participantes pueden torcerse, jalar, romperse
          o lesionarse gravemente externa o internamente su cabeza, cara
          (incluyendo nariz y dientes / mandíbula), cuello, torso, columna
          vertebral, brazos, muñecas, manos, piernas, tobillos, pies u otras
          partes del cuerpo como resultado de caerse del trampolín o de otros
          equipos, aterrizar de manera inadecuada en los trampolines u otros
          equipos o ponerse en contacto con otros participantes. Como se señaló
          en el párrafo a) anterior, tales lesiones pueden conducir a parálisis,
          desfiguración o muerte. La participación puede provocar un golpe de
          calor, ataques cardíacos, deshidratación y otros eventos médicos
          relacionados con el esfuerzo. c) Los participantes pueden caerse unos
          sobre otros, resultando en huesos rotos y otras lesiones graves. El
          doble rebote, más de una persona por trampolín, voltearse, correr y
          rebotar en las paredes y los trampolines montados en la pared, y otros
          movimientos corporales participantes (ya sean planificados o no)
          pueden crear un efecto de rebote y conducir a movimientos corporales
          impredecibles y anticipados o contacto corporal no anticipado,
          cualquiera de los cuales puede provocar lesiones graves. d) Viajar
          hacia y desde los trampolines puede provocar lesiones físicas
          similares (incluso si el participante no está rebotando en ese
          momento). e) Observar, pararse, sentarse o tomar fotografías en o
          cerca de cualquier trampolín o actividad puede ocasionar lesiones
          físicas similares (incluso si el observador no participa en ese
          momento). !!! - ACUERDO PARA PAGAR MIS PROPIOS GASTOS MÉDICOS
          Reconozco, acepto y asumo el riesgo de todas y cada una de las
          condiciones médicas, limitaciones o discapacidades (ya sean temporales
          o permanentes) que yo o el Niño poseamos, ya sean conocidas o
          desconocidas, que puedan contribuir o exacerbar cualquier lesión que
          yo o el Niño podría sostenerse como resultado del uso de Sociedad
          HAPPYLAND Perú S.A. o cualquiera de sus equipos. Reconozco y acepto
          que si se requiere o se realiza asistencia médica (de cualquier forma,
          incluida la atención de emergencia, hospitalización, atención
          ambulatoria y / o fisioterapia) como resultado de cualquier lesión que
          yo o el Niño suframos mientras usamos Sociedad HAPPYLAND Perú S.A.,
          dicha asistencia correrá por mi cuenta. !!! - LIBERACIÓN DE
          RESPONSABILIDAD Las Partes exoneradoras por este medio, liberan de
          manera irrevocable e incondicional, renuncian, renuncian, exoneran de
          responsabilidad y se comprometen a no demandar a Sociedad HAPPYLAND
          Perú S.A., y sus sucesores, predecesores en interés y aseguradores
          (colectivamente, los "Exonerados") de todos y cada uno reclamos,
          demandas, derechos, acciones, demandas, causas de acción,
          obligaciones, deudas, costos, pérdidas, cargos, gastos, honorarios de
          abogados, daños, juicios y responsabilidades, de cualquier tipo o
          naturaleza, en derecho, equidad o de otro tipo, ya sea ahora conocido
          o desconocido, sospechoso o insospechado, y oculto u oculto,
          relacionado o derivado, directa o indirectamente, del acceso y / o uso
          de mi o del Niño a la Instalación, los locales y / o su equipo de
          Sociedad HAPPYLAND Perú S.A. ( ya sean trampolines u otros), la
          entrada del Niño y / o mi en la Instalación de obstáculos del
          Happyland Adventure, la condición, mantenimiento, inspección,
          supervisión, control o seguridad de la Instalación de obstáculos del
          Happyland Adventure, la falta de advertencia de condiciones peligrosas
          iones en conexión con Sociedad HAPPYLAND Perú S.A., y / o los actos u
          omisiones de Sociedad HAPPYLAND Perú S.A. o cualquiera de las
          Liberaciones, incluyendo, entre otros, cualquier reclamo por
          negligencia, falta de advertencia u otra omisión, daños a la
          propiedad, lesiones personales, lesiones emocionales , enfermedad,
          daño corporal, parálisis o muerte. Entiendo que este lanzamiento y
          exención se aplica no solo al uso de los trampolines, sino también a
          todos los demás equipos, y a todas las actividades y juegos en
          Sociedad HAPPYLAND Perú S.A.. Entiendo que esta exención y exención se
          aplica e incluye todas las actividades en las que yo o mi hijo
          realizamos en las instalaciones, ya sea dentro o fuera de Sociedad
          HAPPYLAND Perú S.A.. En el caso de que cualquier reclamo publicado en
          este documento sea presentado o presentado en nombre de las Partes
          exoneradoras, defenderé, indemnizaré y eximiré de responsabilidad a
          los exonerados, y a cualquiera de ellos, de cualquier pérdida o
          responsabilidad, incluidos los honorarios razonables de abogados. ,
          asociado con el mismo o derivado del mismo. !!! - ARBITRAJE DE
          DISPUTAS; LÍMITE DE TIEMPO PARA PRESENTAR LA RECLAMACIÓN Entiendo que
          al aceptar arbitrar cualquier disputa como se establece en esta
          sección, renuncio a mi derecho y los derechos de los menores de edad
          anteriores para mantener una demanda contra Sociedad HAPPYLAND Perú
          S.A. y los otros Liberados por cualquier y todas las reclamaciones
          cubiertas por este Acuerdo. Al aceptar el arbitraje, entiendo que NO
          tendré derecho a que un jurado determine mi reclamo, y los hijos
          menores mencionados NO tendrán derecho a que un jurado determine los
          reclamos. Recíprocamente, Sociedad HAPPYLAND Perú S.A. y los otros
          Liberados renuncian a su derecho a mantener una demanda contra mí y el
          (los) menor (es) menor (es) por cualquier reclamo cubierto por este
          Acuerdo, y no tendrán derecho a que un jurado determine su (s) reclamo
          (s). CUALQUIER DISPUTA, RECLAMACIÓN O CONTROVERSIA DERIVADA O
          RELACIONADA CON EL ACCESO DE MI NIÑO Y / O EL USO DEL Sociedad
          HAPPYLAND Perú S.A. Y / O SU EQUIPO, INCLUYENDO LA DETERMINACIÓN DEL
          ALCANCE O LA APLICABILIDAD DE ESTE ACUERDO DE ARBITRAJE, SERÁ CORRECTO
          DENTRO DE UN AÑO DE SU ACUMULACIÓN (es decir, la fecha de la supuesta
          lesión) Y SER DETERMINADO POR ARBITRAJE EN EL CONDADO DE LA
          INSTALACIÓN Planet Obstacle, FLORIDA, ANTES DE UN ÁRBITRO. EL
          ARBITRAJE SERÁ ADMINISTRADO POR JAMS DE ACUERDO CON SU REGLA 16.1
          REGLAS Y PROCEDIMIENTOS DE ARBITRAJE EXPEDITOS. EL JUICIO SOBRE EL
          PREMIO PUEDE SER INSCRITO EN CUALQUIER TRIBUNAL QUE TENGA
          JURISDICCIÓN. ESTA CLÁUSULA NO IMPEDIRÁ A LAS PARTES QUE BUSQUEN
          RECURSOS PROVISIONALES EN AYUDA DEL ARBITRAJE DE UN TRIBUNAL DE
          JURISDICCIÓN APROPIADA. Este Acuerdo se regirá, interpretará e
          interpretará de acuerdo con las leyes del Estado de Florida, sin tener
          en cuenta los principios de elección de ley. A pesar de la disposición
          con respecto a la ley sustantiva aplicable, cualquier arbitraje
          realizado de conformidad con los términos de este Acuerdo se regirá
          por la Ley Federal de Arbitraje (9 U.S.C., Sec. 1-16). Entiendo y
          reconozco que las Reglas de arbitraje de JAMS con las que estoy de
          acuerdo están disponibles en línea para mi revisión en jamsadr.com, e
          incluyen las Reglas y procedimientos de arbitraje integrales de JAMS;
          Regla 16.1 Procedimientos acelerados; y, Política sobre estándares
          mínimos de equidad procesal para el consumidor. !! - FOTO / VIDEO /
          RENUNCIA A MEDIOS SOCIALES En relación con mi uso y el del Niño de
          Planet Obstacle Facility, doy mi consentimiento para la grabación del
          Niño y mi imagen física y / o voz a través de medios mecánicos,
          fotográficos, técnicos, digitales, electrónicos u otros
          ("Grabaciones"). Por la presente, doy mi consentimiento y autorizo ​​a
          Planet Obstacle y sus agentes, representantes, empleados, sucesores y
          cesionarios para usar, a perpetuidad, tales Grabaciones, así como el
          nombre del Niño y mi nombre, para cualquier propósito, incluyendo
          publicidad, promoción, explotación y / o publicitar cualquier
          instalación de Planet Obstacle. Además, acepto que lo anterior incluye
          el consentimiento para usar el Niño y / o mi imagen física en
          cualquier forma. Además, renuncio a todas y cada una de las
          reclamaciones que pueda tener en relación con las Grabaciones. !!! -
          PLAZO DE ACUERDO (es válido y aplica para siempre? Y en Perú) Entiendo
          que este acuerdo se extiende para siempre en el futuro y tendrá plena
          vigencia y efecto legal cada vez que yo o mi (s) hijo (s) / pupilo (s)
          visiten Planet Obstacle, ya sea en la ubicación actual o en cualquier
          otra ubicación o instalación. !! - LA SEGURIDAD ES SU RESPONSABILIDAD:
          YO Y CADA NIÑO ACEPTAMOS SEGUIR EL CÓDIGO DE RESPONSABILIDAD DEL
          PATRÓN: a) Usted reconoce que existen riesgos inherentes a la
          participación en cualquier tribunal de trampolín, y que dichos riesgos
          incluyen no solo el uso de trampolines, sino también otras actividades
          y equipos. Los clientes de un tribunal de trampolines que usan
          trampolines, y aquellos que participan en cualquier otra actividad o
          usan cualquier otro equipo, por participación, aceptan los riesgos
          inherentes a dicha participación de los cuales la persona prudente
          ordinaria es o debería ser consciente. Los usuarios tienen el deber de
          ejercer un buen juicio y actuar de manera responsable al usar la
          cancha de trampolín y otros equipos, y al participar en tales
          actividades. Los usuarios tienen el deber de obedecer todas las
          advertencias orales o escritas, o ambas, antes o durante la
          participación, o ambas. b) Usted tiene el deber de no participar en
          ninguna actividad en ningún tribunal de trampolín, o participar en
          cualquier otra actividad o usar cualquier otro equipo, bajo la
          influencia de drogas o alcohol. c) Usted tiene el deber de usar
          adecuadamente todo el equipo de seguridad provisto, ya sea para los
          trampolines en la cancha de trampolines o de otra manera. d) Usted
          tiene el deber de no participar en ninguna actividad en cualquier
          cancha de trampolín, o participar en otras actividades o usar otro
          equipo, si tiene afecciones médicas preexistentes, afecciones
          circulatorias, afecciones cardíacas o pulmonares, cirugías recientes,
          espalda o cuello afecciones, afecciones de la rodilla o el tobillo,
          presión arterial alta, embarazo conocido, antecedentes de lesiones en
          la columna vertebral, musculoesqueléticas o en la cabeza, o si puede
          estar embarazada. e) Tiene el deber de quitarse la vestimenta
          inapropiada, incluidos objetos duros, afilados o peligrosos, como
          hebillas, bolígrafos, carteras, insignias, etc. f) Usted tiene el
          deber de evitar el contacto corporal con otros clientes. g) Usted
          tiene el deber de cumplir o cumplir con las restricciones de altura,
          peso o edad impuestas por el fabricante o propietario para usar o
          participar en cualquier actividad del parque de trampolines, ya sea
          que implique el uso de trampolines o de otra manera. h) Tiene el deber
          de evitar amontonar o sobrecargar secciones individuales de la cancha
          de trampolín u otro equipo. i) Tiene el deber de utilizar la cancha de
          trampolín y otros equipos, dentro de sus propias limitaciones,
          capacitación y habilidades adquiridas. j) Tiene el deber de evitar
          aterrizar en la cabeza o el cuello. Se pueden producir lesiones
          graves, parálisis o la muerte al aterrizar en la cama de la cancha de
          trampolín, o en otro lugar, ya sea que involucre el trampolín, otro
          equipo o de otra manera. k) También acepta seguir y obedecer todas las
          advertencias publicadas y declaradas y las señales de educación del
          cliente. l) Usted acepta explicar todas las reglas de seguridad a cada
          Niño que acompaña y asegurarse de que cada Niño obedezca las reglas de
          seguridad. !!! - AVISO AL PADRE MENOR O NATURAL GUARDIÁN: LEA ESTE
          FORMULARIO COMPLETAMENTE Y CUIDADOSAMENTE. USTED ACEPTA QUE SU HIJO
          MENOR PARTICIPE EN UNA ACTIVIDAD POTENCIALMENTE PELIGROSA. USTED
          ACEPTA QUE, INCLUSO SI Sociedad HAPPYLAND Perú S.A.Y TODAS LAS DEMÁS
          PUBLICACIONES UTILIZAN CUIDADOS RAZONABLES AL PROPORCIONAR ESTA
          ACTIVIDAD, HAY UNA OPORTUNIDAD DE QUE SU HIJO PUEDA SER LESIONADO O
          MATADO POR PARTICIPAR EN ESTA ACTIVIDAD PORQUE CIERTOS PELIGROS SON
          INHERENTES EN LA ACTIVIDAD QUE NO PUEDE SER EVITADO O ELIMINADO. AL
          FIRMAR ESTE FORMULARIO, ESTÁ RENUNCIANDO EL DERECHO DE SU HIJO Y SU
          DERECHO A RECUPERARSE DE Sociedad HAPPYLAND Perú S.A.Y TODAS LAS OTRAS
          COMUNICACIONES EN UNA DEMANDA POR CUALQUIER LESIÓN PERSONAL, INCLUIDA
          LA MUERTE, A SU HIJO O CUALQUIER DAÑO A LA PROPIEDAD QUE RESULTE DE
          LOS RIESGOS QUE SON UN RIESGO PARTE NATURAL DE LA ACTIVIDAD. USTED
          TIENE EL DERECHO DE NEGARSE A FIRMAR ESTE FORMULARIO, y Sociedad
          HAPPYLAND Perú S.A.Y TODAS LAS DEMÁS PUBLICACIONES TIENEN EL DERECHO
          DE NEGARSE A DEJAR QUE SU HIJO PARTICIPE SI NO FIRMA ESTE FORMULARIO.
          He leído y entiendo el párrafo anterior. He tenido la oportunidad
          suficiente de leer este documento. He leído y entendido y acepto estar
          sujeto a sus términos. Entiendo que los empleados que trabajan en
          Sociedad HAPPYLAND Perú S.A., incluido el gerente, no tienen la
          autoridad para renunciar a ninguna disposición de este Acuerdo. Este
          Acuerdo constituye y contiene el acuerdo completo entre Sociedad
          HAPPYLAND Perú S.A.y yo en relación con el Niño y mi uso de Sociedad
          HAPPYLAND Perú S.A.. No existen otros acuerdos, orales, escritos o
          implícitos, con respecto a tales asuntos. Además, acepto que esta
          publicación se interpretará de conformidad con las leyes del estado de
          Florida. Si algún término o disposición de esta Liberación se
          considera ilegal, inaplicable o en conflicto con alguna ley que rija
          esta Liberación, la validez de las partes restantes no se verá
          afectada de este modo. Al firmar a continuación, declaro y garantizo
          que soy el padre, el tutor legal, el tutor natural o el poder notarial
          de los Niños mencionados anteriormente y que tengo la autoridad para
          ejecutar este Acuerdo en su nombre y para actuar en su nombre o el de
          ellos. He leído todos y cada uno párrafo de este documento y yo y
          ellos acordamos estar sujetos a los términos establecidos en el mismo,
          incluida la exención de responsabilidad contenida en el mismo. Además,
          estoy de acuerdo en indemnizar y eximir de responsabilidad a los
          Liberados de cualquiera y todas las reclamaciones presentadas por o en
          nombre de este o estos Menores o Menores, o cualquiera de ellos, que
          de alguna manera estén relacionados, surjan o resulten de su uso de
          Sociedad HAPPYLAND Perú S.A.. Tengo 18 años de edad o más. Estoy
          firmando este acuerdo en nombre mío, de mi cónyuge o pareja de hecho,
          del Niño y de nuestro problema respectivo y / o colectivo, padres,
          hermanos, herederos, cesionarios, representantes personales,
          patrimonio (s) y cualquier otra persona que pueda reclamar por o a
          través de dicha persona o personas (colectivamente, las "Partes
          liberadoras"). EN RESUMEN, POR MI FIRMA A CONTINUACIÓN, RECONOZCO QUE
          SI YO O CUALQUIERA DE MIS HIJOS SE LESIONAN DE ALGUNA FORMA, ESTA
          RENUNCIA PREVIENE Y PROHIBE CUALQUIER RECUPERACIÓN DE DINERO DE
          CUALQUIER ENTIDAD RELACIONADA CON EL Sociedad HAPPYLAND Perú S.A.
          <br />
          <br />
          <strong
            >Padre / tutor legal / poder notarial / participante (si tiene 18
            años o más): </strong
          >{{ nameParent }}
          <br />
          <strong v-if="adult">
            Nombre de (los) niño(s):
          </strong>
          <br />
          <List class="list">
            <ListItem v-for="child in childs" :key="child._id"
              >{{ child.names }} {{ child.surname }}
            </ListItem>
          </List>
          <br />
        </p>
      </Col>
    </Row>
    <Row type="flex" justify="center">
      <Col span="20" style="text-align:center">
        <button
          class="notSignature"
          style="border: none"
          v-if="notSignature"
          @click="signature"
        >
          Firma aquí
        </button>
        <VueSignaturePad
          height="50vh"
          width="50vw"
          v-else
          ref="signaturePad"
          saveType="image/png"
          style="margin: auto; border: 1px solid black;"
        />
      </Col>
    </Row>
    <Row>
      <Col span="12" offset="2">
        <Form ref="form" :model="form" :rules="validateForm">
          <FormItem prop="terms">
            <Checkbox class="font-20" v-model="form.terms"
              >Estoy de acuerdo con los términos y condiciones del
              contrato.</Checkbox
            >
          </FormItem>
        </Form>
      </Col>
    </Row>
    <!-- <pdf
      :page="page"
      @num-pages="numPages = $event"
      style="width:75%"
      src="../static/happyland-contract.pdf"
    ></pdf>-->
    <Row>
      <Col span="5" offset="19">
        <!-- <Button @click="downloadPDF">Click</Button> -->
        <Button :loading="next" @click="nextPage">Finalizar</Button>
      </Col>
    </Row>
    <!-- <div>
      <client-only placeholder="Loading...">
        <pdf
          class="pdf"
          :src="require('@/static/happyland-contract.pdf')"
          :page="1"
        ></pdf>
      </client-only>
    </div> -->
    <div id="ticket">
      <img src="../assets/images/logo-happy.jpg" class="img-ticket" />
      <h1>TICKET</h1>
      <p>{{ this.actualMoment }}</p>
      <p>{{ this.nameParent }}</p>
      <p>{{ this.birthday.slice(0, 10) }}</p>
      <p>Hijos</p>
      <p v-for="child in childs" :key="child._id">
        {{ child.names }} {{ child.surname }} -
        {{ child.identityDocumentNumber }} - {{child.age}} años
      </p>
    </div>
  </section>
</template>

<script>
import Vue from "vue";
import VueSignaturePad from "vue-signature-pad";
import localStorage from "localStorage";
// import jsPDF from "jspdf";
import * as Api from "../../server/index";
import "../assets/css/style.css";
import pdfMake from "pdfmake/build/pdfmake";
import pdfFonts from "pdfmake/build/vfs_fonts";
import VueHtmlToPaper from "vue-html-to-paper";
import moment from "moment";
Vue.use(VueHtmlToPaper);
pdfMake.vfs = pdfFonts.pdfMake.vfs;
Vue.use(VueSignaturePad);

export default {
  data() {
    const validateTerms = (rule, value, callback) => {
      if (value == false || !value) {
        callback(new Error("Es obligatorio"));
      } else {
        callback();
      }
    };
    return {
      nameParent: "",
      childs: [],
      birthday: "",
      output: null,
      actualMoment: "",
      parentData: {},
      notSignature: true,
      email: "",
      code: "",
      allData: "",
      pdf: "",
      object: {},
      childContract: "",
      next: false,
      adult: false,
      form: {
        terms: false
      }, // single checkbox value
      validateForm: {
        terms: [{ validator: validateTerms, trigger: "change" }]
      }
    };
  },
  methods: {
    signature() {
      this.notSignature = false;
    },
    nextPage() {
      this.$refs["form"].validate(async valid => {
        if (valid) {
          // const parent = JSON.parse(localStorage.getItem("data"));
          let idParent = localStorage.getItem("parentId");
          Api.getFatherById(idParent).then(res => {
            this.parentData = res.data;
            this.nameParent =
              this.parentData.names +
              " " +
              this.parentData.surname +
              " - " +
              this.parentData.identityDocumentNumber;
            this.childs = this.parentData.childs;
            this.code = this.parentData.fatherRandom;
            this.email = this.parentData.email;
            this.object = {
              childs: this.childs,
              parentFullName: this.nameParent,
              email: this.email,
              code: this.code
            };
            this.object.childs.forEach(child => {
              this.childContract =
                child.names +
                " " +
                child.surname +
                " -  " +
                child.identityDocumentNumber +
                ", ";
            });

            if (this.notSignature == true) {
              this.$Notice.error({
                title: "Debe firmar"
              });
            } else if (this.$refs.signaturePad == undefined) {
              this.$Notice.error({
                title: "Debe firmar"
              });
            } else {
              const data = this.$refs.signaturePad.saveSignature().data;
              this.next = true;
              var testImageDataUrl = data;
              var docDefinition = {
                content: [
                  {
                    style: "header",
                    text:
                      "Acuerdo del participante, liberación y asunción de riesgos (El Acuerdo) - Sociedad HAPPYLAND Perú S.A."
                  },
                  {
                    style: "header",
                    text:
                      "\n1 - Acuerdo del participante, liberación y asunción de riesgos"
                  },
                  '\nElegí voluntariamente usar y permitir que los menores de edad identificados anteriormente, los cuales se encuentran bajo mi tutela, y han sido referidos individual y colectivamente en este documento como "menor de edad ", usen las instalaciones y equipos de Sociedad HAPPYLAND Perú S.A. ubicados en centro comercial Mall Aventura Santa Anita Zona de Happyland Adventure. En consideración a que se nos permita usar dichas instalaciones y equipos, y cualquier otro servicio proporcionado por Sociedad Happyland Perú S.A. o sus empleados o agentes en dicha ubicación, o en cualquier otra ubicación dentro de la ciudad de Lima, declaro, reconozco y acepto lo siguiente:',
                  "\n•	Reconozco y acepto que este Acuerdo cubre y está destinado a liberar y proporcionar otros beneficios, protecciones legales y consideraciones a favor de Sociedad HAPPYLAND Perú S.A., y sus respectivos agentes y colectivos, propietarios, funcionarios, gerentes, accionistas, afiliados, voluntarios, participantes, empleados, y todas las demás personas o entidades que actúen en cualquier capacidad en su nombre respectivo o colectivo.",
                  "\n•	Reconozco y acepto que el uso de los equipos de la Zona de Happyland Adventure, así como otros equipos de propiedad de Sociedad HAPPYLAND Perú S.A. pueden conllevar riesgos, los cuales incluyen lesiones físicas o emocionales graves, muerte, daños a mí mismo, a los menor de edad  y/o a terceros, y daños a la propiedad personal de cualquiera o todas esas personas. Entiendo que tales riesgos no pueden eliminarse, ya que forman parte inherente de las cualidades esenciales de la actividad recreativa, lo cual acepto y reconozco completamente de forma voluntaria. ",
                  "\n•	Reconozco y acepto que, si bien los empleados de Sociedad HAPPYLAND Perú S.A. supervisan generalmente la Zona de Happyland Adventure y otras actividades localizadas en otras zonas que tienen lugar en los locales de Sociedad HAPPYLAND Perú S.A., no es factible que dichos empleados supervisen las actividades y acciones de todos los clientes en todo momento o en forma simultáneamente. ",
                  "\n•	Reconozco y acepto que yo y los menores de edad estamos participando voluntariamente bajo nuestro propio riesgo.",
                  "\nReconozco y acepto que las acciones o actividades de otros clientes podrían causarme a mí o a los menores de edad lesiones corporales significativas  y que Sociedad HAPPYLAND Perú S.A. no es responsable de las acciones o actividades de clientes que usan las instalaciones de Sociedad HAPPYLAND Perú S.A., incluyendo la zona Happyland Adventure. Algunos de los riesgos incluyen, entre otros, los siguientes:",
                  "\na) Los participantes podrían llegar a morir o quedar paralizados, parcial o totalmente, a través del uso de las instalaciones de Sociedad HAPPYLAND Perú S.A., incluyendo la zona Happyland Adventure.",
                  "\nb) Los participantes pueden sufrir cortes, raspones, golpes, contusiones, conmociones cerebrales, a través del uso del equipo de Sociedad HAPPYLAND Perú S.A., o el contacto con otros participantes o superficies con las que han contactado. Los participantes pueden torcerse, jalar, romperse o lesionarse gravemente externa o internamente la cabeza, cara (incluyendo nariz y dientes / mandíbula), cuello, torso, columna vertebral, brazos, muñecas, manos, piernas, tobillos, pies u otras partes del cuerpo como resultado de caerse del trampolín o de otros equipos, aterrizar de manera inadecuada en los trampolines u otros equipos o ponerse en contacto con otros participantes. Como se señaló en el párrafo a) anterior, tales lesiones pueden conducir a parálisis, desfiguración o muerte. La participación puede provocar un golpe de calor, ataques cardíacos, deshidratación y otros eventos médicos relacionados con el esfuerzo.",
                  "\nc) Los participantes pueden caerse unos sobre otros, resultando en huesos rotos y otras lesiones graves. El doble rebote, más de una persona por trampolín, voltearse, correr y rebotar en las paredes y los trampolines montados en la pared, y otros movimientos corporales participantes (ya sean planificados o no) pueden crear un efecto de rebote y conducir a movimientos corporales impredecibles y anticipados o contacto corporal no anticipado, cualquiera de los cuales puede provocar lesiones graves.",
                  "\nd) Hacer uso del área de los trampolines, puede provocar lesiones físicas similares (incluso si el participante no está rebotando en ese momento).",
                  "\ne) Observar, pararse, sentarse o tomar fotografías en o cerca de cualquier trampolín o actividad puede ocasionar lesiones físicas similares (incluso si el observador no participa en ese momento).",
                  "\n•	Reconozco, acepto y asumo el riesgo de todas y cada una de las condiciones médicas, limitaciones o discapacidades (ya sean temporales o permanentes) que yo o los menor es de edad  poseamos, ya sean conocidas o desconocidas, que puedan contribuir o exacerbar cualquier lesión que yo o los menores de edad  podríamos sostener como resultado del uso de las instalaciones de Sociedad HAPPYLAND Perú S.A. o cualquiera de sus equipos. ",
                  "\n•	Reconozco y acepto que si se requiere o se realiza asistencia médica (de cualquier forma, incluida la atención de emergencia, hospitalización, atención ambulatoria y/o fisioterapia) como resultado de cualquier lesión que yo o los menores de edad suframos mientras usamos la Zona de Happyland Adventure o cualquier otra zona de Sociedad HAPPYLAND Perú S.A., dicha asistencia correrá por mi cuenta. Sin perjuicio de ello, Sociedad HAPPYLAND Perú S.A. podrá prestar primeros auxilios en caso sea necesario, conforme sus políticas internas.",
                  {
                    style: "header",
                    text: "\n2 - FOTO / VIDEO / RENUNCIA A MEDIOS SOCIALES"
                  },
                  "\nEn relación con el uso de las instalaciones de la zona Happyland Adventure y otras zonas a las que yo y los menor de edad podamos tener acceso, en mi calidad de titular de la patria potestad o tutor de los menores, doy mi consentimiento libre, previo, expreso e inequívoco para el tratamiento de mis datos personales y los de los menores.",
                  '\nEn ese sentido, doy mi autorización para la grabación de los menores de edad  y mi imagen física y/o voz a través de medios mecánicos, fotográficos, técnicos, digitales, electrónicos u otros ("Grabaciones"). Por la presente, doy mi consentimiento y autorizo ​​a Sociedad HAPPYLAND Perú S.A. y sus agentes, representantes, empleados, sucesores y cesionarios para usar, a perpetuidad, tales Grabaciones, así como el nombre de los menor de edad y mi nombre, para los siguientes propósitos: publicidad, promoción, explotación y/o publicitar cualquier instalación de Sociedad HAPPYLAND Perú S.A. Además, acepto que lo anterior incluye el consentimiento para usar el Niño y/o mi imagen física en cualquier forma. ',
                  {
                    style: "header",
                    text: "\n3 – SOBRE LOS REGLAMENTOS Y PROHIBCIONES"
                  },
                  "\nReconozco y declaro que antes de hacer uso de las instalaciones de Sociedad HAPPYLAND Perú S.A., he leído los reglamentos de uso de cada uno de ellos, por lo que manifiesto haber sido debido(a) y suficientemente informado(a) en relación a las reglas que rigen para mí y aquellos menor de edad  respecto de quienes autorizo participar en cualquier actividad dentro de los juegos que conforman el entretenimiento de Sociedad HAPPYLAND Perú S.A.",
                  "\nAsimismo, dejo expresa constancia que entiendo y he explicado las referidas reglas a los menores respecto de quienes autorizo participar. Reconozco también que en caso no se sigan las reglas preestablecidas por Sociedad HAPPYLAND Perú S.A., en cada uno de los diferentes juegos de Sociedad HAPPYLAND Perú S.A., este comportamiento puede resultar en mi exclusión o la de aquellos menores respecto de quienes autorizo participar de los juegos, sin tener –ni esperar- un resarcimiento o devolución del importe de dinero invertido.",
                  `\nNombres y apellidos: ${this.object.parentFullName}`,
                  `\nHijos: ${this.childContract}`,
                  "\nFirma",
                  {
                    image: testImageDataUrl,
                    width: 200
                  }
                ],
                images: {
                  bee: testImageDataUrl
                },
                styles: {
                  header: {
                    fontSize: 18,
                    bold: true
                  }
                },
                defaultStyle: {
                  alignment: "justify"
                }
              };
              const pdfDocGenerator = pdfMake.createPdf(docDefinition);
              pdfDocGenerator.getBase64(data => {
                console.log(data);
                this.pdf = "data:application/pdf;base64," + data;
                Api.sendEmail(this.object.email, this.object.code, this.pdf)
                  .then(res => {
                    this.next = false;
                    console.log(res);
                    this.$htmlToPaper("ticket");
                    this.$router.push("./thanks");
                  })
                  .catch(err => {
                   this.next = false;
                    console.log(res);
                    this.$htmlToPaper("ticket");
                    this.$router.push("./thanks");
                  });
              });
            }
          });
        } else {
          this.$Notice.error({
            title: "Error de registro",
            desc: "Debe aceptar términos y condiciones para poder continuar"
          });
        }
      });
    }
  },
  async created() {
    moment.locale("es");
    this.actualMoment = moment().format("LLLL");
    let idParent = localStorage.getItem("parentId");
    Api.getFatherById(idParent).then(res => {
      this.parentData = res.data;
      if (
        moment(this.parentData.birthday).isAfter(moment().subtract(18, "years"))
      ) {
        this.adult = false;
      } else {
        this.adult = true;
      }
      this.nameParent =
        this.parentData.names +
        " " +
        this.parentData.surname +
        " - " +
        this.parentData.identityDocumentNumber;
      this.childs = this.parentData.childs;
      this.birthday = this.parentData.birthday.slice(0, 10);
      console.log(this.childs);
    });
  }
};
</script>

<style scoped>
.pdf {
  border: 1px solid red;
  width: 100%;
  height: 100%;
}
.notSignature {
  background-color: #fcfeff;
  color: #338dc8;
  border: none;
  height: 50vh;
  font-family: "Montserrat-light";
}
.notSignature:focus {
  outline: 0;
}
</style>
