import SignaturePad from"signature_pad";import mergeImages from"merge-images";function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread2(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(b,!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(b).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_nonIterableSpread()}function _arrayWithoutHoles(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function _iterableToArray(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var SAVE_TYPE=["image/png","image/jpeg","image/svg+xml"],checkSaveType=function(a){return SAVE_TYPE.includes(a)},DEFAULT_OPTIONS={dotSize:3/2,minWidth:.5,maxWidth:2.5,throttle:16,minDistance:5,backgroundColor:"rgba(0,0,0,0)",penColor:"black",velocityFilterWeight:.7,onBegin:function(){},onEnd:function(){}},convert2NonReactive=function(a){return JSON.parse(JSON.stringify(a))},TRANSPARENT_PNG={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",x:0,y:0},VueSignaturePad={name:"VueSignaturePad",props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},customStyle:{type:Object},saveType:{type:String,default:"image/png"},options:{type:Object,default:function(){return{}}},images:{type:Array,default:function(){return[]}}},data:function(){return{signaturePad:{},cacheImages:[],signatureData:TRANSPARENT_PNG,onResizeHandler:null}},mounted:function(){var a=this.options,b=this.$refs.signaturePadCanvas,c=new SignaturePad(b,_objectSpread2({},DEFAULT_OPTIONS,{},a));this.signaturePad=c,this.onResizeHandler=this.resizeCanvas.bind(this),window.addEventListener("resize",this.onResizeHandler,!1),this.resizeCanvas()},beforeDestroy:function(){this.onResizeHandler&&window.removeEventListener("resize",this.onResizeHandler,!1)},methods:{resizeCanvas:function(){var a=this.$refs.signaturePadCanvas,b=this.signaturePad.toData(),c=Math.max(window.devicePixelRatio||1,1);a.width=a.offsetWidth*c,a.height=a.offsetHeight*c,a.getContext("2d").scale(c,c),this.signaturePad.clear(),this.signatureData=TRANSPARENT_PNG,this.signaturePad.fromData(b)},saveSignature:function(){var a=this.signaturePad,b=this.saveType,c={isEmpty:!1,data:void 0};if(!checkSaveType(b))throw new Error("Image type is incorrect!");return a.isEmpty()?_objectSpread2({},c,{isEmpty:!0}):(this.signatureData=a.toDataURL(b),_objectSpread2({},c,{data:this.signatureData}))},undoSignature:function(){var a=this.signaturePad,b=a.toData();if(b)return a.fromData(b.slice(0,-1))},mergeImageAndSignature:function(a){return this.signatureData=a,mergeImages([].concat(_toConsumableArray(this.images),_toConsumableArray(this.cacheImages),[this.signatureData]))},addImages:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return this.cacheImages=[].concat(_toConsumableArray(this.cacheImages),_toConsumableArray(a)),mergeImages([].concat(_toConsumableArray(this.images),_toConsumableArray(this.cacheImages),[this.signatureData]))},fromDataURL:function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},c=2<arguments.length?arguments[2]:void 0;return this.signaturePad.fromDataURL(a,b,c)},fromData:function(a){return this.signaturePad.fromData(a)},toData:function(){return this.signaturePad.toData()},lockSignaturePad:function(){return this.signaturePad.off()},openSignaturePad:function(){return this.signaturePad.on()},isEmpty:function(){return this.signaturePad.isEmpty()},getPropImagesAndCacheImages:function(){return this.propsImagesAndCustomImages},clearCacheImages:function(){return this.cacheImages=[],this.cacheImages},clearSignature:function(){return this.signaturePad.clear()}},computed:{propsImagesAndCustomImages:function(){var a=convert2NonReactive(this.images),b=convert2NonReactive(this.cacheImages);return[].concat(_toConsumableArray(a),_toConsumableArray(b))}},watch:{options:function(a){var b=this;Object.keys(a).forEach(function(c){b.signaturePad[c]&&(b.signaturePad[c]=a[c])})}},render:function(a){var b=this.width,c=this.height,d=this.customStyle;return a("div",{style:_objectSpread2({width:b,height:c},d)},[a("canvas",{style:{width:"100%",height:"100%"},ref:"signaturePadCanvas"})])}};VueSignaturePad.install=function(a){return a.component(VueSignaturePad.name,VueSignaturePad)},"undefined"!=typeof window&&window.Vue&&window.Vue.use(VueSignaturePad);export default VueSignaturePad;
